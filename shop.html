<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - Uncle Ben's Pizza üçï</title>
    <link rel="icon" type="image/jpg" href="favicon.jpg">
    <link rel="shortcut icon" type="image/jpg" href="favicon.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Supabase credentials
        const supabaseUrl = 'https://tgkiktklknwyohadenbd.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRna2lrdGtsa253eW9oYWRlbmJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIzNzQ1OTAsImV4cCI6MjA3Nzk1MDU5MH0.74kBuL5I3aORpII7m6fsXavm6Kd1RaLy1byx4mqjnoc';

        function initializeSupabaseShop() {
            if (typeof supabase !== 'undefined' && supabaseUrl.startsWith('http')) {
                try {
                    if (!window.supabase || typeof window.supabase.from !== 'function') {
                        window.supabase = supabase.createClient(supabaseUrl, supabaseAnonKey);
                        console.log('‚úì Supabase client initialized (shop)');
                    } else {
                        console.log('‚úì Supabase client already initialized (shop)');
                    }
                } catch (error) {
                    console.error('‚úó Error initializing Supabase client (shop):', error);
                }
            } else {
                if (typeof supabase === 'undefined') {
                    console.warn('‚ö† Supabase SDK not loaded yet (shop), retrying...');
                    setTimeout(initializeSupabaseShop, 100);
                } else {
                    console.warn('‚ö† Invalid Supabase URL for shop page');
                }
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSupabaseShop);
        } else {
            initializeSupabaseShop();
        }

        window.addEventListener('load', function() {
            if (!window.supabase) {
                console.log('Window loaded (shop), attempting Supabase initialization...');
                initializeSupabaseShop();
            }
        });
    </script>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --neon-blue: #00d4ff;
            --neon-pink: #ff006e;
            --neon-green: #39ff14;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
        }
        
        .font-orbitron {
            font-family: 'Orbitron', monospace;
        }
        
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .gradient-text {
            color: white;
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.3);
        }
        
        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px var(--neon-blue); }
            50% { box-shadow: 0 0 40px var(--neon-blue), 0 0 60px var(--neon-blue); }
        }
        
        .cart-item {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .category-tab {
            transition: all 0.3s ease;
        }
        
        .category-tab.active {
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            color: white;
        }
        
        .quantity-btn {
            transition: all 0.2s ease;
        }
        
        .quantity-btn:hover {
            transform: scale(1.1);
        }
        #shopHero {
            padding-top: 150px;
        }
    </style>
</head>
<body class="text-white overflow-x-hidden">
    <!-- Floating Cart Button (mobile + tablet only) -->
    <div id="floating-cart-btn"
        class="fixed bottom-6 right-6 z-40 flex items-center justify-center 
        w-16 h-16 rounded-full shadow-xl cursor-pointer
        bg-gradient-to-br from-green-400 to-blue-500">
        
        <svg xmlns="http://www.w3.org/2000/svg" 
            class="h-7 w-7 text-white" fill="none" 
            viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" 
                stroke-width="2" 
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.293 2.293A1 1 0 007 17h12m-5 4a1 1 0 100-2 
                1 1 0 000 2zm-6 0a1 1 0 100-2 1 1 0 000 2z" />
        </svg>

        <!-- Cart count bubble -->
        <span id="floating-cart-count"
            class="absolute -top-1 -right-1 bg-red-600 text-white text-xs 
            font-bold w-6 h-6 flex items-center justify-center rounded-full shadow-lg">
            0
        </span>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass">
        <div class="container head-nav mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <a href="index.html" class="flex items-center">
                    <img src="favicon.jpg" id="logoImage" alt="Uncle Ben's Pizza" class="h-8 w-8 rounded-full mr-2">
                    <span class="font-orbitron text-2xl font-bold gradient-text"></span>
                </a>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="hover:text-blue-400 transition-colors">Home</a>
                    <a href="#menu" class="hover:text-blue-400 transition-colors">Menu</a>
                    <a href="#reviews" class="hover:text-blue-400 transition-colors">Reviews</a>
                    <a href="#booking" class="hover:text-blue-400 transition-colors">Booking</a>
                    <a href="#locations" class="hover:text-blue-400 transition-colors">Locations</a>
                    <a href="#contact" class="hover:text-blue-400 transition-colors">Contact</a>
                </div>
                <div id="cartTrackIcons" class="flex items-center space-x-4">
                    <button id="cart-toggle" class="relative glass px-4 py-2 rounded-lg hover-lift">
                        <i class="fas fa-shopping-cart"></i>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">0</span>
                    </button>
                    <button id="tracking" onclick="window.location.href='tracking.html?order=UB2024003'" class="glass px-4 py-2 rounded-lg hover-lift">
                        <i class="fas fa-truck mr-2"></i>Track Order
                    </button>                    
                </div>
                <button class="md:hidden text-2xl">
                        <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="shopHero" class="pt-20 pb-12 px-4">
        <div class="container mx-auto text-center">
            <h1 class="font-orbitron text-5xl md:text-6xl font-bold mb-6 gradient-text fade-in">
                Our Menu
            </h1>
            <p class="text-xl md:text-2xl mb-8 text-gray-300 max-w-2xl mx-auto fade-in">
                Discover our futuristic collection of delicious meals and beverages
            </p>
        </div>
    </section>

    <!-- Category Tabs -->
    <section class="py-8 px-4">
        <div class="container mx-auto">
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button class="category-tab active glass px-6 py-3 rounded-full font-semibold" data-category="all">
                    <i class="fas fa-th-large mr-2"></i>All Items
                </button>
                <button class="category-tab glass px-6 py-3 rounded-full font-semibold" data-category="pizza">
                    <i class="fas fa-pizza-slice mr-2"></i>Pizzas
                </button>
                <button class="category-tab glass px-6 py-3 rounded-full font-semibold" data-category="jollof">
                    <i class="fas fa-utensils mr-2"></i>Jollof Rice
                </button>
                <button class="category-tab glass px-6 py-3 rounded-full font-semibold" data-category="chicken">
                    <i class="fas fa-drumstick-bite mr-2"></i>Chicken
                </button>
                <button class="category-tab glass px-6 py-3 rounded-full font-semibold" data-category="minerals">
                    <i class="fas fa-wine-bottle mr-2"></i>Minerals
                </button>
            </div>
        </div>
    </section>

    <!-- Menu Items -->
    <section id="menu" class="py-12 px-4">
        <div class="container mx-auto">
            <div id="menu-container">
                <!-- Products will be loaded here dynamically -->
            </div>
        </div>
    </section>

    <!-- Shopping Cart Sidebar -->
    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-96 bg-black bg-opacity-90 backdrop-blur-xl transform translate-x-full transition-transform duration-300 z-50">
        <div class="p-6 h-full flex flex-col">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold gradient-text">Shopping Cart</h2>
                <button id="close-cart" class="text-2xl hover:text-red-400 transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="cart-items" class="flex-1 overflow-y-auto mb-6">
                <!-- Cart items will be dynamically added here -->
            </div>
            
            <div class="border-t border-white/20 pt-6">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-xl font-semibold">Total:</span>
                    <span id="cart-total" class="text-2xl font-bold text-green-400">‚Çµ0</span>
                </div>
                
                <div class="space-y-3">
                    <!-- <button id="checkout-btn" class="w-full bg-gradient-to-r from-green-500 to-blue-500 py-3 rounded-lg font-semibold hover-lift">
                        <i class="fas fa-credit-card mr-2"></i>Proceed to Checkout
                    </button> -->
                    <button id="clear-cart" class="w-full glass py-3 rounded-lg font-semibold hover-lift">
                        <i class="fas fa-trash mr-2"></i>Clear Cart
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="glass rounded-3xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold gradient-text">Checkout</h3>
                <button id="close-checkout" class="text-2xl hover:text-red-400 transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="checkout-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold mb-2">Full Name</label>
                    <input name="name" type="text" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-400 transition-colors" required>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold mb-2">Phone Number</label>
                    <input name="phone" type="tel" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-400 transition-colors" required>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold mb-2">Email Address</label>
                    <input name="email" type="email" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-400 transition-colors" required>
                </div>

                <div>
                    <label class="block text-sm font-semibold mb-2">Delivery Address</label>
                    <textarea name="address" rows="3" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-400 transition-colors resize-none" required></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold mb-2">Order Type</label>
                    <select name="orderType" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-400 transition-colors">
                        <option>Delivery</option>
                        <option>Pickup</option>
                    </select>
                </div>
                
                <div class="border-t border-white/20 pt-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="font-semibold">Order Total:</span>
                        <span id="checkout-total" class="text-xl font-bold text-green-400">‚Çµ0</span>
                    </div>
                    
                    <button type="submit" id="paystack-btn" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 py-3 rounded-lg font-semibold hover-lift">
                        <i class="fas fa-check mr-2"></i>Place Order
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="glass mt-20">
        <div class="container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <img src="favicon.jpg" alt="Uncle Ben's Pizza" class="h-8 w-8 rounded-full mr-3">
                        <h3 class="font-orbitron text-2xl font-bold gradient-text">Uncle Ben's Pizza üçï</h3>
                    </div>
                    <p class="text-gray-300">Experience the future of pizza with our glassmorphic, neon-lit dining experience.</p>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-blue-400 transition-colors">Home</a></li>
                        <li><a href="#menu" class="text-gray-300 hover:text-blue-400 transition-colors">Menu</a></li>
                        <li><a href="index.html#booking" class="text-gray-300 hover:text-blue-400 transition-colors">Booking</a></li>
                        <li><a href="index.html#locations" class="text-gray-300 hover:text-blue-400 transition-colors">Locations</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Services</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-blue-400 transition-colors">Delivery</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-blue-400 transition-colors">Pickup</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-blue-400 transition-colors">Catering</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-blue-400 transition-colors">Events</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Contact Info</h4>
                    <ul class="space-y-2">
                        <li class="text-gray-300">Phone: 0240597979</li>
                        <li class="text-gray-300">Email: info@unclebenspizza.com</li>
                        <li class="text-gray-300">Hours: 8AM - 10PM</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-white/20 mt-8 pt-8 text-center">
                <p class="text-gray-300">&copy; 2024 Uncle Ben's Pizza. All rights reserved. Built with futuristic technology.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const menuContainer = document.getElementById('menu-container');
            const categoryTabs = document.querySelectorAll('.category-tab');
            let allProducts = [];
            // This will store the quantities for items on the shop page before they are added to the cart
            let quantities = JSON.parse(localStorage.getItem('uncleBensQuantities')) || {};

            const categoryMappings = {
                'pizza': 'Pizza',
                'jollof': 'Jollof Rice',
                'chicken': 'Chicken',
                'minerals': 'Minerals'
            };

            const categoryHeadings = {
                'Pizza': 'Premium Pizzas',
                'Jollof Rice': 'Jollof Rice',
                'Chicken': 'Premium Chicken üçó',
                'Minerals': 'Cold Minerals & Drinks'
            };

            async function loadProducts() {
                try {
                    const response = await fetch('products.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    allProducts = await response.json();
                    renderProducts(getActiveCategory());
                } catch (error) {
                    console.error("Could not load products:", error);
                    menuContainer.innerHTML = '<p class="text-center text-red-400">Failed to load menu. Please try again later.</p>';
                }
            }

            function createProductCard(product) {
                const isMineral = product.category === 'Minerals';
                const gridClass = isMineral ? 'grid-cols-2 md:grid-cols-4 lg:grid-cols-6' : 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3';
                const cardLayout = isMineral ?
                    `
                    <div class="glass rounded-xl p-4 text-center hover-lift fade-in group" data-category="${product.category.toLowerCase().replace(' ','')}">
                        <div class="w-16 h-16 rounded-full mx-auto mb-3 overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        </div>
                        <h4 class="font-semibold mb-2">${product.name}</h4>
                        <p class="text-sm text-gray-300 mb-3">‚Çµ${product.price}</p>
                        <div class="flex items-center justify-center space-x-2 mb-3">
                            <button class="quantity-btn bg-gray-600 w-6 h-6 rounded-full flex items-center justify-center text-xs" onclick="window.updateQuantity('${product.id}', -1)">-</button>
                            <span id="${product.id}-qty" class="w-6 text-center text-sm">${quantities[product.id] || 0}</span>
                            <button class="quantity-btn bg-gray-600 w-6 h-6 rounded-full flex items-center justify-center text-xs" onclick="window.updateQuantity('${product.id}', 1)">+</button>
                        </div>
                        <button onclick="window.addToCart('${product.id}', '${product.name}', ${product.price})" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 py-2 rounded-lg text-sm font-semibold hover-lift">
                            Add to Cart
                        </button>
                    </div>
                    ` :
                    `
                    <div class="glass rounded-2xl p-6 hover-lift fade-in group" data-category="${product.category.toLowerCase()}">
                        <div class="w-full h-48 rounded-xl mb-4 overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-2xl font-bold mb-2">${product.name}</h3>
                        <p class="text-gray-300 mb-4">${product.description}</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-2xl font-bold text-green-400">‚Çµ${product.price}</span>
                            <div class="flex items-center space-x-2">
                                <button class="quantity-btn bg-gray-600 w-8 h-8 rounded-full flex items-center justify-center" onclick="window.updateQuantity('${product.id}', -1)">-</button>
                                <span id="${product.id}-qty" class="w-8 text-center">${quantities[product.id] || 0}</span>
                                <button class="quantity-btn bg-gray-600 w-8 h-8 rounded-full flex items-center justify-center" onclick="window.updateQuantity('${product.id}', 1)">+</button>
                            </div>
                        </div>
                        <button onclick="window.addToCart('${product.id}', '${product.name}', ${product.price})" class="w-full bg-gradient-to-r from-green-500 to-blue-500 py-2 rounded-lg font-semibold hover-lift">
                            Add to Cart
                        </button>
                    </div>
                    `;
                return { html: cardLayout, grid: gridClass, category: product.category };
            }

            function getActiveCategory() {
                const activeTab = document.querySelector('.category-tab.active');
                return activeTab ? activeTab.dataset.category : 'all';
            }

            function renderProducts(filter) {
                const filteredProducts = (filter === 'all') ? allProducts : allProducts.filter(p => categoryMappings[filter] === p.category);
                
                const productsByCategory = filteredProducts.reduce((acc, product) => {
                    if (!acc[product.category]) acc[product.category] = [];
                    acc[product.category].push(product);
                    return acc;
                }, {});

                menuContainer.innerHTML = Object.keys(productsByCategory).map(category => {
                    const products = productsByCategory[category] || [];
                    if (products.length === 0) return '';
                    const { grid } = createProductCard(products[0]);
                    return `
                        <div class="category-section mb-12">
                            <h2 class="font-orbitron text-3xl font-bold mb-8 gradient-text text-center">${categoryHeadings[category]}</h2>
                            <div class="grid ${grid} gap-8">
                                ${products.map(p => createProductCard(p).html).join('')}
                            </div>
                        </div>
                    `;
                }).join('');

                // Add fade-in effect
                setTimeout(() => {
                    document.querySelectorAll('#menu-container .fade-in').forEach(el => el.classList.add('visible'));
                }, 50);
            }

            // --- Functions for quantity and cart ---
            function setQuantityDisplay(id, value) {
                const qtyElement = document.getElementById(`${id}-qty`);
                if (qtyElement) {
                    qtyElement.textContent = value;
                }
            }

            window.updateQuantity = (id, delta) => {
                const currentQty = quantities[id] || 0;
                const newQty = Math.max(0, currentQty + delta);
                quantities[id] = newQty;
                setQuantityDisplay(id, newQty);
                localStorage.setItem('uncleBensQuantities', JSON.stringify(quantities));
            };

            window.addToCart = (id, name, price) => {
                const quantityToAdd = Math.max(quantities[id] || 0, 1);
                window.addToCartFromIndex(id, name, price, quantityToAdd, false); // This function is in script.js
                quantities[id] = 0;
                setQuantityDisplay(id, 0);
                localStorage.setItem('uncleBensQuantities', JSON.stringify(quantities));
                window.showNotification(`${quantityToAdd} √ó ${name} added to cart!`, 'success');
            };

            categoryTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove 'active' class from all tabs
                    categoryTabs.forEach(t => t.classList.remove('active'));
                    // Add 'active' class to the clicked tab
                    tab.classList.add('active');
                    renderProducts(tab.dataset.category);
                });
            });

            loadProducts();
        });
    </script>

    <!-- PayStack -->
    <script src="https://js.paystack.co/v1/inline.js"></script>


    <!--Start of Tawk.to Script-->
    <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
    var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
    s1.async=true;
    s1.src='https://embed.tawk.to/68cf2e6a09337d191a0e1737/1j5kkqkkt';
    s1.charset='UTF-8';
    s1.setAttribute('crossorigin','*');
    s0.parentNode.insertBefore(s1,s0);
    })();
    </script>
    <!--End of Tawk.to Script-->
</body>
</html>
